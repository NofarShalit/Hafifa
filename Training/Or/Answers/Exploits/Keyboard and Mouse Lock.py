import win32api
import ctypes
from ctypes import wintypes
from time import sleep

def main():
    BlockInput = ctypes.windll.user32.BlockInput
    BlockInput.argtypes = [wintypes.BOOL]
    BlockInput.restype = wintypes.BOOL

    BlockInput(True)
    sleep(3)
    BlockInput(False)
    ctypes.windll.user32.LockWorkStation()
    ctypes.windll.user32.BlockInput()
    """
    blocked = BlockInput(True)
    if blocked:
        try:
            print("Blocked")
            sleep(5)
        finally:
            unlocked = BlockInput(False)
    else:
        raise RuntimeError('Input is blocked, wrongggg')
    """

if __name__ == "__main__":
    main()