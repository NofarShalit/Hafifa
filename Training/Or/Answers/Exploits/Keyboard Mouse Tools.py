import pythoncom, pyHook
import win32api, win32con
import keyboard, mouse
import ctypes
from time import sleep
import itertools
import threading

MENU =  """
Choose wisely:
1) Lock Mouse and Keyboard
2) Lock Mouse
3) Lock Keyboard
4) Switch Mouse Buttons
5) Trollololololololol
Input: """
SENTENCE = itertools.cycle('Well hello there, ')

# Block return False,
# Questions 2 and 3
def Block(event):
    return False

# Question 1
def LockMouseAndKeyboard():
    ok = ctypes.windll.user32.BlockInput(True)

# Question 4
def OnLeftDown(event):
    global HookCaller
    if HookCaller:
        HookCaller = False
        return True
    else:
        Thread = threading.Thread(target=win32api.mouse_event,args=(win32con.MOUSEEVENTF_LEFTDOWN,0,0))
        Thread.start()
        HookCaller = True
        return False

def OnLeftUp(event):
    global HookCaller
    if HookCaller:
        HookCaller = False
        return True
    else:
        Thread = threading.Thread(target=win32api.mouse_event,args=(win32con.MOUSEEVENTF_LEFTUP,0,0))
        Thread.start()
        HookCaller = True
        return False

def OnRightDown(event):
    global HookCaller
    if HookCaller:
        HookCaller = False
        return True
    else:
        Thread = threading.Thread(target=win32api.mouse_event,args=(win32con.MOUSEEVENTF_RIGHTDOWN,0,0))
        Thread.start()
        HookCaller = True
        return False

def OnRightUp(event):
    global HookCaller
    if HookCaller:
        HookCaller = False
        return True
    else:
        Thread = threading.Thread(target=win32api.mouse_event,args=(win32con.MOUSEEVENTF_RIGHTUP,0,0))
        Thread.start()
        HookCaller = True
        return False

# Question 5
def TypeKeys(event):
    global flag
    flag += 1
    if flag % 3:
        char = SENTENCE.__next__()
        print(char)
        flag += 1
        keyboard.write(str(char))
        return False
    return True

def main():
    choice = int(input(MENU))
    HookManager = pyHook.HookManager()

    if choice == 1:
        LockMouseAndKeyboard()
        sleep(5)
    elif choice == 2:
        HookManager.MouseAll = Block
    elif choice == 3:
        HookManager.KeyAll = Block
    elif choice == 4:
        global HookCaller
        HookCaller = False
        HookManager.MouseLeftDown = OnRightDown
        HookManager.MouseLeftUp = OnRightUp
        HookManager.MouseRightDown = OnLeftDown
        HookManager.MouseRightUp = OnLeftUp
    elif choice == 5:
        global flag; flag = 0
        HookManager.KeyDown = TypeKeys
        HookManager.KeyUp = Block

    HookManager.HookMouse()
    HookManager.HookKeyboard()
    pythoncom.PumpMessages()

if __name__ == "__main__":
    main()