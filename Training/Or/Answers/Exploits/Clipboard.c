#include <windows.h>
#include <dos.h>
#include <conio.h>
#include <string.h>
#include <stdio.h>

#pragma warning(disable:4996)
#define ESC_CODE 27

int main()
{
	HWND handle = NULL;
	int num = 0;
	char sentence[64] = "";
	char command[] = "powershell.exe -c Set-Clipboard ";
	while (num != 4) {
		num = 0;
		printf("\nDo you want to:\n");
		printf("1) Get Clipboard Data\n");
		printf("2) Set Clipboard Data\n");
		printf("3) Lock The Clipboard\n");
		printf("4) Exit The Program\n");
		scanf_s("%d", &num);

		if (num == 1)
		{
			system("powershell.exe -c Get-Clipboard");
		}
		else if (num == 2)
		{/*
			HANDLE HandleData;
			char Data[128] = ""; scanf("%s", Data);
			char* pData = NULL;
			int DataLength = sizeof(Data);
			HandleData = GlobalAlloc(GMEM_MOVEABLE | GMEM_DDESHARE, DataLength + 1);
			pData = (char*)GlobalLock(HandleData);
			memcpy(pData, Data, DataLength + 1);
			GlobalUnlock(HandleData);
			OpenClipboard(NULL);
			EmptyClipboard();
			SetClipboardData(CF_UNICODETEXT, HandleData);
			CloseClipboard();
			*/
			//OpenClipboard(handle2);
			//EmptyClipboard();
			//handle2 = "kosomo";
			//SetClipboardData(CF_UNICODETEXT, handle2);
				

			printf("What would you like to enter: ");
			scanf("%s", sentence);
			strcat(command, sentence);
			system(command);
			memcpy(sentence, 0, sizeof(sentence) + 1);
			sentence[0] = '\0';
			strcpy(sentence, "");
		}
		else if (num == 3)
		{
			OpenClipboard(handle);
			Sleep(1111111111);
		}
		else if (num == 4)
		{
			free(command); free(sentence);
		}
		CloseClipboard();
	}
	return 0;
}