1. מתקפת golden ticket היא מתקפה בה התוקף משיג גישה לסיסמה של krbtgt ומזייף TGT שתקף לתקופת זמן בלתי מוגבלת ומקנה גישה לכל השירותים.
הדרישות למתקפה הן הרשאות גבוהות והתחברות לDC.
השלב הראשון הוא להוציא את הסיסמה של krbtgt ואת שם וSID הדומיין בכל דרך שהיא.
השלב השני הוא ליצור golden ticket עם הפרמטרים הדרושים- שם משתמש, ID, קבוצות להם המשתמש יהיה שייך וSIDים.
השלב השלישי הוא להריץ CMD בו הticket טעון ומשם יש גישה לכל המחשבים בדומיין בהרשאות גבוהות.
2. ניתן לממש את המתקפה באמצעות mimikatz-
שלב 1- privilege::debug
lsadump::lsa /inject /name:krbtgt
שלב 2- kerberos::golden /domain: /sid: /rc4: /user: /id: /ptt
שלב 3-misc::cmd
ניתן לזהות golden ticket אם מתבצעות בקשות הנפקת כרטיס לTGS מבלי בקשה קודמת לTGT, ולפי עוד רמזים כמו תוקף לא סביר של שנים, שם מזוייף, וכו
בשביל להגן מהמתקפה חייבים למנוע גישה בהרשאות גבוהות לDC מראש.
דרך אחת להגן מפני golden ticket היא principle of least priviledge- למזער את הכמות של מתשמשי admin ולצמצם את השימוש בהם כדי להקשות על התוקף להתחבר לDC
דרך שנייה היא הגבלות רשתיות על DCים, שיהיה אפשר להתחבר אליהם אדמיניסטריבית רק משרתים מסויימים ומבודדים.
